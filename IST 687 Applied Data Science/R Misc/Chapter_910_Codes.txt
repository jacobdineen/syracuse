readCensus <- function() 
{
  urlToRead <- "http://www2.census.gov/programs-surveys/popest/tables/2010-2011/state/totals/nst-est2011-01.csv"
  testFrame <- read.csv(url(urlToRead))
  testFrame<-testFrame[-1:-8,]
  testFrame<-testFrame[,1:5]
  testFrame$stateName <- testFrame[,1]
  testFrame<-testFrame[,-1]
  testFrame<-testFrame[-52:-58,]
  testFrame$stateName <- gsub("\\.","", testFrame$stateName)
  testFrame$april10census <-Numberize(testFrame$X)
  testFrame$april10base <-Numberize(testFrame$X.1)
  testFrame$july10pop <-Numberize(testFrame$X.2)
  testFrame$july11pop <-Numberize(testFrame$X.3)
  testFrame <- testFrame[,-1:-4]
  rownames(testFrame) <- NULL
  return(testFrame)
}
Numberize <- function(inputVector)
{
  inputVector<-gsub(",","", inputVector)
  inputVector<-gsub(" ","", inputVector)
  return(as.numeric(inputVector))
}
USstatePops <- readCensus()
USstatePops$april10census[1:3]
mean(USstatePops$april10census)
median(USstatePops$april10census)
mode(USstatePops$april10census)
var(USstatePops$april10census)
sd(USstatePops$april10census)
hist(USstatePops$april10census)
hist(USstatePops$april10census, breaks=20)
hist(rnorm(51, 6043834, 6823984))
sample(USstatePops$april10census, size=8,replace=TRUE)
mean(sample(USstatePops$april10census,size=16,replace=TRUE))
replicate(4, mean(sample(USstatePops$april10census,size=16,replace=TRUE)),simplify=TRUE)
mean(replicate(400,mean(sample(USstatePops$april10census, size=16,replace = TRUE)), simplify=TRUE))
mean(replicate(4000, mean(sample(USstatePops$april10census, size=16,replace = TRUE)), simplify=TRUE))
hist(replicate(4000,mean(sample(USstatePops$april10census,size=16,replace= TRUE)), simplify=TRUE))
mean(replicate(100, mean(sample(USstatePops$april10census,size =51,replace = TRUE)), simplify=TRUE))
mean(replicate(100, mean(sample(USstatePops$april10census, size=120,replace=TRUE)), simplify=TRUE))
SampleMeans <- replicate(10000,mean(sample(USstatePops$april10census,size =5, replace = TRUE)), simplify=TRUE)
length(SampleMeans)
mean(SampleMeans)
summary(SampleMeans)
quantile(SampleMeans, probs=c(0.25,0.50,0.75))
quantile(SampleMeans, probs=c(0.025,0.975))
  MysterySample <- c(3706690, 159358, 106405,55519, 53883)
mean(MysterySample)

quantile(SampleMeans, probs=c(0.005,0.995))
sd(SampleMeans)
sd(USstatePops$april10census)/sqrt(5)
StdError <- sd(USstatePops$april10census)/sqrt(5)
CutPoint975 <- mean(USstatePops$april10census)+(2 * StdError)
CutPoint975